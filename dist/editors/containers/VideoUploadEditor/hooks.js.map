{"version":3,"file":"hooks.js","names":["_react","_interopRequireDefault","require","_module","_interopRequireWildcard","_redux","_store","appHooks","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","extToMime","mp4","mov","navigateTo","exports","state","loading","val","React","useState","errorMessage","textInputValue","uploadEditor","setLoading","module","setErrorMessage","uploader","settextInputValue","postUploadRedirect","storeState","learningContextId","selectors","app","blockId","videoUrl","onVideoUpload","store","getState","getFileExtension","filename","slice","Math","abs","lastIndexOf","fileValidator","uploadVideo","file","supportedFormats","keys","ext","name","type","newFile","File","includes","supportedFiles","setLoadSpinner","errorMsg","_default"],"sources":["../../../../src/editors/containers/VideoUploadEditor/hooks.js"],"sourcesContent":["import React from 'react';\nimport * as module from './hooks';\nimport { selectors } from '../../data/redux';\nimport store from '../../data/store';\nimport * as appHooks from '../../hooks';\n\nconst extToMime = {\n  mp4: 'video/mp4',\n  mov: 'video/quicktime',\n};\n\nexport const {\n  navigateTo,\n} = appHooks;\n\nexport const state = {\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  loading: (val) => React.useState(val),\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  errorMessage: (val) => React.useState(val),\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  textInputValue: (val) => React.useState(val),\n};\n\nexport const uploadEditor = () => {\n  const [loading, setLoading] = module.state.loading(false);\n  const [errorMessage, setErrorMessage] = module.state.errorMessage(null);\n  return {\n    loading,\n    setLoading,\n    errorMessage,\n    setErrorMessage,\n  };\n};\n\nexport const uploader = () => {\n  const [textInputValue, settextInputValue] = module.state.textInputValue('');\n  return {\n    textInputValue,\n    settextInputValue,\n  };\n};\n\nexport const postUploadRedirect = (storeState) => {\n  const learningContextId = selectors.app.learningContextId(storeState);\n  const blockId = selectors.app.blockId(storeState);\n  return (videoUrl) => navigateTo(`/course/${learningContextId}/editor/video/${blockId}?selectedVideoUrl=${videoUrl}`);\n};\n\nexport const onVideoUpload = () => {\n  const storeState = store.getState();\n  return module.postUploadRedirect(storeState);\n};\n\nconst getFileExtension = (filename) => filename.slice(Math.abs(filename.lastIndexOf('.') - 1) + 2);\n\nexport const fileValidator = (setLoading, setErrorMessage, uploadVideo) => (file) => {\n  const supportedFormats = Object.keys(extToMime);\n  const ext = getFileExtension(file.name);\n  const type = extToMime[ext] || '';\n  const newFile = new File([file], file.name, { type });\n\n  if (supportedFormats.includes(ext)) {\n    uploadVideo({\n      supportedFiles: [newFile],\n      setLoadSpinner: setLoading,\n      postUploadRedirect: onVideoUpload(),\n    });\n  } else {\n    const errorMsg = 'Video must be an MP4 or MOV file';\n    setErrorMessage(errorMsg);\n  }\n};\n\nexport default {\n  postUploadRedirect,\n  uploadEditor,\n  uploader,\n  onVideoUpload,\n  fileValidator,\n};\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,OAAA,GAAAC,uBAAA,CAAAF,OAAA;AACA,IAAAG,MAAA,GAAAH,OAAA;AACA,IAAAI,MAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,QAAA,GAAAH,uBAAA,CAAAF,OAAA;AAAwC,SAAAM,yBAAAC,WAAA,eAAAC,OAAA,kCAAAC,iBAAA,OAAAD,OAAA,QAAAE,gBAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,CAAAC,WAAA,WAAAA,WAAA,GAAAG,gBAAA,GAAAD,iBAAA,KAAAF,WAAA;AAAA,SAAAL,wBAAAS,GAAA,EAAAJ,WAAA,SAAAA,WAAA,IAAAI,GAAA,IAAAA,GAAA,CAAAC,UAAA,WAAAD,GAAA,QAAAA,GAAA,oBAAAA,GAAA,wBAAAA,GAAA,4BAAAE,OAAA,EAAAF,GAAA,UAAAG,KAAA,GAAAR,wBAAA,CAAAC,WAAA,OAAAO,KAAA,IAAAA,KAAA,CAAAC,GAAA,CAAAJ,GAAA,YAAAG,KAAA,CAAAE,GAAA,CAAAL,GAAA,SAAAM,MAAA,WAAAC,qBAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,GAAA,IAAAX,GAAA,QAAAW,GAAA,kBAAAH,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAd,GAAA,EAAAW,GAAA,SAAAI,IAAA,GAAAR,qBAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAV,GAAA,EAAAW,GAAA,cAAAI,IAAA,KAAAA,IAAA,CAAAV,GAAA,IAAAU,IAAA,CAAAC,GAAA,KAAAR,MAAA,CAAAC,cAAA,CAAAH,MAAA,EAAAK,GAAA,EAAAI,IAAA,YAAAT,MAAA,CAAAK,GAAA,IAAAX,GAAA,CAAAW,GAAA,SAAAL,MAAA,CAAAJ,OAAA,GAAAF,GAAA,MAAAG,KAAA,IAAAA,KAAA,CAAAa,GAAA,CAAAhB,GAAA,EAAAM,MAAA,YAAAA,MAAA;AAAA,SAAAlB,uBAAAY,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAExC,MAAMiB,SAAS,GAAG;EAChBC,GAAG,EAAE,WAAW;EAChBC,GAAG,EAAE;AACP,CAAC;AAEM,MAAM;EACXC;AACF,CAAC,GAAG1B,QAAQ;AAAC2B,OAAA,CAAAD,UAAA,GAAAA,UAAA;AAEN,MAAME,KAAK,GAAG;EACnB;EACAC,OAAO,EAAGC,GAAG,IAAKC,cAAK,CAACC,QAAQ,CAACF,GAAG,CAAC;EACrC;EACAG,YAAY,EAAGH,GAAG,IAAKC,cAAK,CAACC,QAAQ,CAACF,GAAG,CAAC;EAC1C;EACAI,cAAc,EAAGJ,GAAG,IAAKC,cAAK,CAACC,QAAQ,CAACF,GAAG;AAC7C,CAAC;AAACH,OAAA,CAAAC,KAAA,GAAAA,KAAA;AAEK,MAAMO,YAAY,GAAGA,CAAA,KAAM;EAChC,MAAM,CAACN,OAAO,EAAEO,UAAU,CAAC,GAAGC,OAAM,CAACT,KAAK,CAACC,OAAO,CAAC,KAAK,CAAC;EACzD,MAAM,CAACI,YAAY,EAAEK,eAAe,CAAC,GAAGD,OAAM,CAACT,KAAK,CAACK,YAAY,CAAC,IAAI,CAAC;EACvE,OAAO;IACLJ,OAAO;IACPO,UAAU;IACVH,YAAY;IACZK;EACF,CAAC;AACH,CAAC;AAACX,OAAA,CAAAQ,YAAA,GAAAA,YAAA;AAEK,MAAMI,QAAQ,GAAGA,CAAA,KAAM;EAC5B,MAAM,CAACL,cAAc,EAAEM,iBAAiB,CAAC,GAAGH,OAAM,CAACT,KAAK,CAACM,cAAc,CAAC,EAAE,CAAC;EAC3E,OAAO;IACLA,cAAc;IACdM;EACF,CAAC;AACH,CAAC;AAACb,OAAA,CAAAY,QAAA,GAAAA,QAAA;AAEK,MAAME,kBAAkB,GAAIC,UAAU,IAAK;EAChD,MAAMC,iBAAiB,GAAGC,gBAAS,CAACC,GAAG,CAACF,iBAAiB,CAACD,UAAU,CAAC;EACrE,MAAMI,OAAO,GAAGF,gBAAS,CAACC,GAAG,CAACC,OAAO,CAACJ,UAAU,CAAC;EACjD,OAAQK,QAAQ,IAAKrB,UAAU,CAAE,WAAUiB,iBAAkB,iBAAgBG,OAAQ,qBAAoBC,QAAS,EAAC,CAAC;AACtH,CAAC;AAACpB,OAAA,CAAAc,kBAAA,GAAAA,kBAAA;AAEK,MAAMO,aAAa,GAAGA,CAAA,KAAM;EACjC,MAAMN,UAAU,GAAGO,cAAK,CAACC,QAAQ,CAAC,CAAC;EACnC,OAAOb,OAAM,CAACI,kBAAkB,CAACC,UAAU,CAAC;AAC9C,CAAC;AAACf,OAAA,CAAAqB,aAAA,GAAAA,aAAA;AAEF,MAAMG,gBAAgB,GAAIC,QAAQ,IAAKA,QAAQ,CAACC,KAAK,CAACC,IAAI,CAACC,GAAG,CAACH,QAAQ,CAACI,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AAE3F,MAAMC,aAAa,GAAGA,CAACrB,UAAU,EAAEE,eAAe,EAAEoB,WAAW,KAAMC,IAAI,IAAK;EACnF,MAAMC,gBAAgB,GAAG9C,MAAM,CAAC+C,IAAI,CAACtC,SAAS,CAAC;EAC/C,MAAMuC,GAAG,GAAGX,gBAAgB,CAACQ,IAAI,CAACI,IAAI,CAAC;EACvC,MAAMC,IAAI,GAAGzC,SAAS,CAACuC,GAAG,CAAC,IAAI,EAAE;EACjC,MAAMG,OAAO,GAAG,IAAIC,IAAI,CAAC,CAACP,IAAI,CAAC,EAAEA,IAAI,CAACI,IAAI,EAAE;IAAEC;EAAK,CAAC,CAAC;EAErD,IAAIJ,gBAAgB,CAACO,QAAQ,CAACL,GAAG,CAAC,EAAE;IAClCJ,WAAW,CAAC;MACVU,cAAc,EAAE,CAACH,OAAO,CAAC;MACzBI,cAAc,EAAEjC,UAAU;MAC1BK,kBAAkB,EAAEO,aAAa,CAAC;IACpC,CAAC,CAAC;EACJ,CAAC,MAAM;IACL,MAAMsB,QAAQ,GAAG,kCAAkC;IACnDhC,eAAe,CAACgC,QAAQ,CAAC;EAC3B;AACF,CAAC;AAAC3C,OAAA,CAAA8B,aAAA,GAAAA,aAAA;AAAA,IAAAc,QAAA,GAEa;EACb9B,kBAAkB;EAClBN,YAAY;EACZI,QAAQ;EACRS,aAAa;EACbS;AACF,CAAC;AAAA9B,OAAA,CAAAnB,OAAA,GAAA+D,QAAA"}